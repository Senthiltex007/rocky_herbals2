{% if level <= 2 %}
<li>

    <!-- âœ… Compact Avatar + Rank Box -->
    <div class="box rank-{{ node.current_rank|default:''|slugify }}"
         onclick="info(
            '{{ node.name }}',
            '{{ node.auto_id }}',
            '{{ node.current_rank|default:"No Rank" }}',
            '{{ node.total_left_bv }}',
            '{{ node.total_right_bv }}',
            '{% if node.avatar %}{{ node.avatar.url }}{% else %}null{% endif %}'
         )"
         style="padding:8px; border-radius:10px; border:2px solid #999; display:inline-block; min-width:120px;">

        {% if node.current_rank %}
            <span class="rank-badge">{{ node.current_rank }}</span>
        {% endif %}

        {% if node.avatar %}
            <img src="{{ node.avatar.url }}" alt="{{ node.name }}"
                 style="width:45px;height:45px;border-radius:50%;margin-bottom:4px;">
        {% else %}
            <img src="/static/images/default-avatar.png" alt="No Avatar"
                 style="width:45px;height:45px;border-radius:50%;margin-bottom:4px;">
        {% endif %}

        <div style="font-size:13px;"><b>{{ node.name }}</b></div>
        <small style="font-size:11px;">{{ node.auto_id }}</small>
    </div>

    <ul>
        {% if node.left_child %}
            {% include "dashboard_tree_box.html" with node=node.left_child level=level|add:1 %}
        {% endif %}

        {% if node.right_child %}
            {% include "dashboard_tree_box.html" with node=node.right_child level=level|add:1 %}
        {% endif %}
    </ul>

</li>
{% endif %}


<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>{{ root_member.name }} - Genealogy Tree</title>

    <style>
        body {
            font-family: Arial, sans-serif;
            background:#f7f9fc;
            margin:0;
        }

        h2 {
            text-align:center;
            padding:18px;
            background:#004aad;
            color:white;
            font-size:22px;
            letter-spacing:0.5px;
        }

        .tree {
            width:100%;
            overflow-x:auto;
            text-align:center;
            margin-top:25px;
            padding-bottom:40px;
        }

        .tree ul {
            padding-top:20px;
            position:relative;
            display:flex;
            justify-content:center;
            gap:40px;
        }

        .tree li {
            list-style:none;
            text-align:center;
            position:relative;
            padding:20px 10px 0 10px;
        }

        .tree li::before, .tree li::after {
            content:'';
            position:absolute;
            top:0;
            width:50%;
            height:20px;
            border-top:2px solid #b5b5b5;
        }

        .tree li::before {
            left:-50%;
            border-right:2px solid #b5b5b5;
        }

        .tree li::after {
            right:-50%;
            border-left:2px solid #b5b5b5;
        }

        .tree li:only-child::before,
        .tree li:only-child::after {
            display:none;
        }

        .tree li:first-child::before {
            border:none;
        }

        .tree li:last-child::after {
            border:none;
        }

        .box {
            background:white;
            padding:15px;
            border-radius:12px;
            min-width:160px;
            box-shadow:0 4px 12px rgba(0,0,0,0.12);
            border:1px solid #e0e0e0;
            transition:0.25s;
            cursor:pointer;
        }

        .box:hover {
            transform:scale(1.05);
            box-shadow:0 6px 18px rgba(0,0,0,0.18);
        }

        .avatar {
            width:70px;
            height:70px;
            border-radius:50%;
            object-fit:cover;
            margin-bottom:8px;
            border:3px solid #e6e6e6;
        }

        .add-btn {
            display:inline-block;
            margin-top:10px;
            padding:6px 12px;
            background:#e8ffe8;
            border:1px dashed #00a000;
            color:#008000;
            border-radius:6px;
            font-size:13px;
            text-decoration:none;
        }

        .add-btn:hover {
            background:#caffca;
        }

        @media(max-width:600px){
            .box { min-width:120px; padding:10px; }
            .avatar { width:55px; height:55px; }
            .tree ul { gap:20px; }
        }
    </style>
</head>

<body>

<h2>Genealogy Tree – {{ root_member.name }} ({{ root_member.member_id }})</h2>

<div style="text-align:center; margin-top:10px;">
    <button onclick="zoomIn()" style="padding:6px 12px;">➕ Zoom In</button>
    <button onclick="zoomOut()" style="padding:6px 12px;">➖ Zoom Out</button>
</div>

<div class="tree" id="treeContainer">
    <ul>
        {% include "tree_node.html" with member=root_member %}
    </ul>
</div>

<div id="memberModal" style="
    display:none; position:fixed; top:0; left:0; width:100%; height:100%;
    background:rgba(0,0,0,0.5); justify-content:center; align-items:center;
    z-index:9999;">
    <div style="
        background:white; padding:20px; width:320px; border-radius:12px;
        box-shadow:0 0 20px rgba(0,0,0,0.3); text-align:center;">
        
        <img id="mAvatar" src="/static/default-avatar.png"
             style="width:80px;height:80px;border-radius:50%;margin-bottom:10px;">

        <h3 id="mName"></h3>
        <p>ID: <span id="mID"></span></p>
        <p>Rank: <span id="mRank"></span></p>
        <p>Left BV: <span id="mLBV"></span></p>
        <p>Right BV: <span id="mRBV"></span></p>

        <a id="profileBtn" href="#"
           style="display:inline-block; margin-top:10px; padding:8px 15px;
           background:#004aad; color:white; border-radius:6px; text-decoration:none;">
           View Profile
        </a>

        <br><br>

        <button onclick="closeModal()" style="
            padding:8px 15px; border:none; background:#999; color:white;
            border-radius:6px; cursor:pointer;">
            Close
        </button>
    </div>
</div>

<script>
function info(name, id, rank, lbv, rbv, avatarUrl=null){
    document.getElementById("mName").innerText = name;
    document.getElementById("mID").innerText = id;
    document.getElementById("mRank").innerText = rank;
    document.getElementById("mLBV").innerText = lbv;
    document.getElementById("mRBV").innerText = rbv;

    document.getElementById("mAvatar").src = avatarUrl || "/static/default-avatar.png";
    document.getElementById("profileBtn").href = "/member/detail/" + id + "/";
    document.getElementById("memberModal").style.display = "flex";
}

function closeModal(){
    document.getElementById("memberModal").style.display = "none";
}

let zoom = 1;

function zoomIn(){
    zoom += 0.1;
    document.getElementById("treeContainer").style.transform = "scale(" + zoom + ")";
}

function zoomOut(){
    zoom -= 0.1;
    document.getElementById("treeContainer").style.transform = "scale(" + zoom + ")";
}
</script>

</body>
</html>


<li>

    <!-- ✅ MEMBER BOX WITH AVATAR + RANK BADGE + COLOR -->
    <div class="box rank-{{ node.current_rank|default:''|slugify }}"
         onclick="info(
                '{{ node.name }}',
                '{{ node.auto_id }}',
                '{{ node.current_rank|default:"No Rank" }}',
                '{{ node.total_left_bv }}',
                '{{ node.total_right_bv }}',
                '{% if node.avatar %}{{ node.avatar.url }}{% else %}null{% endif %}'
         )"
         style="padding:12px; border-radius:10px; border:2px solid #999; display:inline-block;">

        <!-- ✅ Rank Badge -->
        {% if node.current_rank %}
            <span class="rank-badge">{{ node.current_rank }}</span>
        {% endif %}

        <!-- ✅ Avatar -->
        {% if node.avatar %}
            <img src="{{ node.avatar.url }}" alt="{{ node.name }}"
                 style="width:60px;height:60px;border-radius:50%;margin-bottom:5px;">
        {% else %}
            <img src="/static/images/default-avatar.png" alt="No Avatar"
                 style="width:60px;height:60px;border-radius:50%;margin-bottom:5px;">
        {% endif %}

        <!-- ✅ Name + ID -->
        <div><b>{{ node.name }}</b></div>
        <small>ID: {{ node.auto_id }}</small>
    </div>


    <!-- ✅ LEFT CHILD OR ADD BUTTON -->
    {% if node.left_child %}
        <ul>
            {% include "herbalapp/tree_box.html" with node=node.left_child %}
        </ul>
    {% else %}
        <a class="add-btn" href="{% url 'add_member' node.auto_id 'left' %}">
            ➕ Add Left
        </a>
    {% endif %}


    <!-- ✅ RIGHT CHILD OR ADD BUTTON -->
    {% if node.right_child %}
        <ul>
            {% include "herbalapp/tree_box.html" with node=node.right_child %}
        </ul>
    {% else %}
        <a class="add-btn" href="{% url 'add_member' node.auto_id 'right' %}">
            ➕ Add Right
        </a>
    {% endif %}

</li>


{% load static %}
<!-- DEBUG: PROJECT TEMPLATE (ACTIVE FILE) -->

<li>

    <!-- ✅ MEMBER BOX -->
    <div class="box rank-{{ member.current_rank|default:'None' }}"
         onclick="info(
             '{{ member.name }}',
             '{{ member.member_id }}',
             '{{ member.current_rank|default:"-" }}',
             '{{ member.total_left_bv }}',
             '{{ member.total_right_bv }}',
             '{% if member.avatar %}{{ member.avatar.url }}{% else %}{% static "default-avatar.png" %}{% endif %}'
         )">

        <!-- ✅ AVATAR DISPLAY -->
        <div style="text-align:center; margin-bottom:5px;">
            {% if member.avatar %}
                <img src="{{ member.avatar.url }}"
                     style="width:60px;height:60px;border-radius:50%;object-fit:cover;">
            {% else %}
                <img src="{% static 'default-avatar.png' %}"
                     style="width:60px;height:60px;border-radius:50%;object-fit:cover;background:#e0e0e0;">
            {% endif %}
        </div>

        {% if member.current_rank %}
            <div class="rank-badge">{{ member.current_rank }}</div>
        {% endif %}

        <strong>{{ member.name }}</strong><br>
        ID: {{ member.member_id }}<br>
        BV: {{ member.total_left_bv }}/{{ member.total_right_bv }}
    </div>

    <!-- ✅ ADD BUTTONS -->
    <div>
        {% if not member.left_member %}
            <a class="add-btn" href="{% url 'add_member' member.id 'left' %}">+ Add Left</a>
        {% endif %}

        {% if not member.right_member %}
            <a class="add-btn" href="{% url 'add_member' member.id 'right' %}">+ Add Right</a>
        {% endif %}
    </div>

    <!-- ✅ CHILDREN (RECURSIVE) -->
    {% if member.left_member or member.right_member %}
    <ul>

        <!-- LEFT CHILD -->
        {% if member.left_member %}
            {% include "tree_node.html" with member=member.left_member %}
        {% else %}
            <li><a class="add-btn" href="{% url 'add_member' member.id 'left' %}">+ Add Left</a></li>
        {% endif %}

        <!-- RIGHT CHILD -->
        {% if member.right_member %}
            {% include "tree_node.html" with member=member.right_member %}
        {% else %}
            <li><a class="add-btn" href="{% url 'add_member' member.id 'right' %}">+ Add Right</a></li>
        {% endif %}

    </ul>
    {% endif %}

</li>

